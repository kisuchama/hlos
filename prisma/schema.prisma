generator js {
  provider        = "prisma-client-js"
  previewFeatures = ["referentialIntegrity"]
}

datasource db {
  provider             = "mysql"
  url                  = env("DATABASE_URL")
  referentialIntegrity = "prisma"
}

model Hero {
  id          Int           @id @default(autoincrement())
  name        String
  surname     String?
  hex         String?       @db.Char(7)
  chibi       String?
  portrait    String?
  substance   String?
  birthday    DateTime?     @db.Date
  height      Int?
  weight      Int?
  sector      Sector?       @relation(fields: [sectorId], references: [id])
  sectorId    Int?
  nameCaller  Appellation[] @relation("Caller")
  isNamed     Appellation[] @relation("Namee")
  events      Event[]
  cards       Card[]
  eventCameos EventCameo[]
  mainCameos  MainCameo[]
  cardCameos  CardCameo[]

  @@index([sectorId])
}

model Sector {
  id       Int     @id @default(autoincrement())
  location String
  color    String?
  hex      String? @db.Char(7)
  heroes   Hero[]
  events   Event[]
}

model Appellation {
  appellation String
  hero        Hero   @relation("Namee", fields: [heroId], references: [id])
  heroId      Int
  caller      Hero   @relation("Caller", fields: [callerId], references: [id])
  callerId    Int

  @@id([heroId, callerId])
}

model Event {
  id        Int         @id @default(autoincrement())
  name      String
  nameJp    String?
  slug      String
  startDate DateTime    @db.Date
  endDate   DateTime    @db.Date
  sector    Sector?     @relation(fields: [sectorId], references: [id])
  sectorId  Int?
  hero      Hero?       @relation(fields: [heroId], references: [id])
  heroId    Int?
  parts     EventPart[]
  cards     Card[]

  @@index([sectorId, heroId])
  @@unique([slug])
}

model EventPart {
  id          Int          @id @default(autoincrement())
  event       Event        @relation(fields: [eventId], references: [id])
  eventId     Int
  part        Int
  translation String?
  cameos      EventCameo[]

  @@index([eventId])
}

model EventCameo {
  hero   Hero      @relation(fields: [heroId], references: [id])
  heroId Int
  part   EventPart @relation(fields: [partId], references: [id])
  partId Int

  @@id([heroId, partId])
}

model Card {
  id          Int         @id @default(autoincrement())
  title       String?
  titleJp     String?
  hero        Hero        @relation(fields: [heroId], references: [id])
  heroId      Int
  event       Event       @relation(fields: [eventId], references: [id])
  eventId     Int
  translation String?
  cameos      CardCameo[]

  @@index([heroId, eventId])
}

model CardCameo {
  hero   Hero @relation(fields: [heroId], references: [id])
  heroId Int
  card   Card @relation(fields: [cardId], references: [id])
  cardId Int

  @@id([heroId, cardId])
}

model MainStory {
  id      Int        @id @default(autoincrement())
  name    String
  season  Int
  chapter Int
  parts   MainPart[]
}

model MainPart {
  id          Int         @id @default(autoincrement())
  chapter     MainStory   @relation(fields: [chapterId], references: [id])
  chapterId   Int
  part        Int
  translation String?
  cameos      MainCameo[]

  @@index([chapterId])
}

model MainCameo {
  hero   Hero     @relation(fields: [heroId], references: [id])
  heroId Int
  part   MainPart @relation(fields: [partId], references: [id])
  partId Int

  @@id([heroId, partId])
}

model a087f013_aae3_537c_92c4_659e68d3a934_20220612135955_vrepl {
  id       Int @id @default(autoincrement())
  event_id Int
  part     Int
  hero_id  Int
  part_id  Int

  @@index([event_id], map: "event_id_idx")
  @@index([hero_id], map: "hero_id_idx")
  @@index([part_id], map: "part_id_idx")
  @@map("_a087f013_aae3_537c_92c4_659e68d3a934_20220612135955_vrepl")
}

model aa6d9409_ade3_58ef_8ba5_a8b798370655_20220612140424_vrepl {
  id       Int @id @default(autoincrement())
  event_id Int
  part     Int
  hero_id  Int

  @@index([event_id], map: "event_id_idx")
  @@index([hero_id], map: "hero_id_idx")
  @@map("_aa6d9409_ade3_58ef_8ba5_a8b798370655_20220612140424_vrepl")
}

model aa9cd50e_fb45_5321_90a3_fb86541da6d6_20220612142140_vrepl {
  id       Int  @id @default(autoincrement())
  event_id Int
  part     Int
  hero_id  Int
  part_id  Int?

  @@index([event_id], map: "event_id_idx")
  @@index([hero_id], map: "hero_id_idx")
  @@index([part_id], map: "part_id_idx")
  @@map("_aa9cd50e_fb45_5321_90a3_fb86541da6d6_20220612142140_vrepl")
}

model ade9f43a_23fa_54c3_8356_2b538b3ccf43_20220612140000_vrepl {
  id         Int       @id @default(autoincrement())
  name       String    @db.VarChar(255)
  name_jp    String?   @db.VarChar(255)
  start_date DateTime  @db.Date
  end_date   DateTime? @db.Date
  sector_id  Int?

  @@index([sector_id], map: "sector_id_idx")
  @@map("_ade9f43a_23fa_54c3_8356_2b538b3ccf43_20220612140000_vrepl")
}
